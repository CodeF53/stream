<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="stylesheet" href="../style.css">
  <style>
    #videoContainer {
      width: 100vw;
      aspect-ratio: 16/9;
      max-height: calc(100vh - 8rem);
      background-image: linear-gradient(to bottom, transparent 70%, #090909);
      background-size: cover;
    }
    #videoFrame {
      aspect-ratio: 16/9;
      width: min(100vw - 20rem, 60rem);
      border: none;
    }
  </style>
  <script type="module" defer>
    import fetchMovieDB from '../api.js'

    const params = Object.fromEntries(new URLSearchParams(window.location.search));
    const { media_type, id } = params
    // const season = params.season || 1
    // const episode = params.episode || 1

    const videoFrame = document.getElementById('videoFrame')

    async function loadPage() {
      const resp = await fetchMovieDB(`${media_type}/${id}`)
      const data = await resp.json()

      console.log(document.getElementById("videoContainer").style)
      document.getElementById("videoContainer").style.backgroundImage =
        `linear-gradient(to bottom, transparent 70%, #090909),
        url(https://image.tmdb.org/t/p/original/${data.backdrop_path})`

      videoFrame.src = `https://vidsrc.to/embed/${media_type}/${id}`
      // if (media_type === 'tv')
      //   videoFrame.src += `/${season}/${episode}`
    }

    loadPage()
  </script>
</head>
<body>
  <div id="videoContainer" class="col centerChildren">
    <iframe id="videoFrame" allowfullscreen></iframe>
    <span>use the controls in the player to set season/episode</span>
  </div>
</body>
</html>